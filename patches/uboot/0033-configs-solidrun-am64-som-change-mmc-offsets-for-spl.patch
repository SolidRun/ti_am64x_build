From dbedd1081dc32e229ee51e730714ecc22fc988e5 Mon Sep 17 00:00:00 2001
From: Josua Mayer <josua@solid-run.com>
Date: Thu, 28 Sep 2023 16:09:44 +0200
Subject: [PATCH] configs: solidrun: am64 som: change mmc offsets for spl/uboot

To make best use of 4MB eMMC boot partitions,
use layout below and configure load sectors accordingly:

   0x0+----------------------------------+
      |           tiboot3.bin            |
 0x400+----------------------------------+
      |           tispl.bin              |
 0xC00+----------------------------------+
      |           u-boot.img             |
0x1C00+----------------------------------+
      |           environment            |
0x2000+----------------------------------+

Signed-off-by: Josua Mayer <josua@solid-run.com>
---
 configs/am64x_a53_solidrun_defconfig | 2 +-
 configs/am64x_r5_solidrun_defconfig  | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/configs/am64x_a53_solidrun_defconfig b/configs/am64x_a53_solidrun_defconfig
index 397b8e2e2b..edbe37e897 100644
--- a/configs/am64x_a53_solidrun_defconfig
+++ b/configs/am64x_a53_solidrun_defconfig
@@ -38,7 +38,7 @@ CONFIG_SPL_SYS_MALLOC_SIMPLE=y
 CONFIG_SPL_STACK_R=y
 CONFIG_SPL_SEPARATE_BSS=y
 CONFIG_SYS_MMCSD_RAW_MODE_U_BOOT_USE_SECTOR=y
-CONFIG_SYS_MMCSD_RAW_MODE_U_BOOT_SECTOR=0x1800
+CONFIG_SYS_MMCSD_RAW_MODE_U_BOOT_SECTOR=0xC00
 CONFIG_SPL_DMA=y
 CONFIG_SPL_ENV_SUPPORT=y
 CONFIG_SPL_ETH_SUPPORT=y
diff --git a/configs/am64x_r5_solidrun_defconfig b/configs/am64x_r5_solidrun_defconfig
index cd2d0a4829..b37be6f09a 100644
--- a/configs/am64x_r5_solidrun_defconfig
+++ b/configs/am64x_r5_solidrun_defconfig
@@ -38,7 +38,7 @@ CONFIG_SPL_STACK_R=y
 CONFIG_SPL_SEPARATE_BSS=y
 CONFIG_SPL_EARLY_BSS=y
 CONFIG_SYS_MMCSD_RAW_MODE_U_BOOT_USE_SECTOR=y
-CONFIG_SYS_MMCSD_RAW_MODE_U_BOOT_SECTOR=0x800
+CONFIG_SYS_MMCSD_RAW_MODE_U_BOOT_SECTOR=0x400
 CONFIG_SPL_DMA=y
 CONFIG_SPL_ENV_SUPPORT=y
 CONFIG_SPL_ETH_SUPPORT=y
-- 
2.35.3

