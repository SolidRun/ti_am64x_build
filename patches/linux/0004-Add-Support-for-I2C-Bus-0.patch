From 9b96a51ce69c8b81ab17995e4e934c37a9339404 Mon Sep 17 00:00:00 2001
From: Alvaro-Karsz <alvaro.karsz@solid-run.com>
Date: Wed, 6 Oct 2021 11:12:37 +0300
Subject: [PATCH] Add Support for I2C Bus 0, remove Buses 2 and 3

---
 arch/arm64/boot/dts/ti/am642-solidrun.dts | 46 ++++++++++++++---------
 1 file changed, 28 insertions(+), 18 deletions(-)

diff --git a/arch/arm64/boot/dts/ti/am642-solidrun.dts b/arch/arm64/boot/dts/ti/am642-solidrun.dts
index 1c773044a..4a131cc4b 100644
--- a/arch/arm64/boot/dts/ti/am642-solidrun.dts
+++ b/arch/arm64/boot/dts/ti/am642-solidrun.dts
@@ -14,7 +14,7 @@
 
 / {
 	compatible =  "ti,am642-evm", "ti,am642";
-	model = "Texas Instruments AM642 EVM";
+	model = "Texas Instruments AM642 SolidRun Board";
 
 	chosen {
 		stdout-path = "serial2:115200n8";
@@ -28,8 +28,8 @@ aliases {
 
 	memory@80000000 {
 		device_type = "memory";
-		/* 2G RAM */
-		reg = <0x00000000 0x80000000 0x00000000 0x80000000>;
+		/* 1G RAM */
+		reg = <0x00000000 0x40000000 0x00000000 0x40000000>;
 
 	};
 
@@ -346,13 +346,19 @@ AM64X_IOPAD(0x0218, PIN_INPUT, 0) /* (A14) SPI0_D1 */
 		>;
 	};
 
+	i2c0_pins: i2c0-pins {
+		pinctrl-single,pins = <
+			AM64X_IOPAD(0x0260, PIN_INPUT_PULLUP, 0) /* (A18) I2C0_SCL */
+			AM64X_IOPAD(0x0264, PIN_INPUT_PULLUP, 0) /* (B18) I2C0_SDA */
+		>;
+	};
+
 	main_i2c1_pins_default: main-i2c1-pins-default {
 		pinctrl-single,pins = <
 			AM64X_IOPAD(0x0268, PIN_INPUT_PULLUP, 0) /* (C18) I2C1_SCL */
 			AM64X_IOPAD(0x026c, PIN_INPUT_PULLUP, 0) /* (B19) I2C1_SDA */
 		>;
 	};
-
 	mdio1_pins_default: mdio1-pins-default {
 		pinctrl-single,pins = <
 			AM64X_IOPAD(0x01fc, PIN_OUTPUT, 4) /* (R2) PRG0_PRU1_GPO19.MDIO0_MDC */
@@ -499,6 +505,14 @@ &mcu_uart1 {
 	status = "disabled";
 };
 
+
+&main_i2c0 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&i2c0_pins>;
+	clock-frequency = <400000>;
+};
+
+
 &main_i2c1 {
 	pinctrl-names = "default";
 	pinctrl-0 = <&main_i2c1_pins_default>;
@@ -520,23 +534,19 @@ exp1: gpio@22 {
 				  "TEST_LED1", "TP92", "TP90", "TP88",
 				  "TP87", "TP86", "TP89", "TP91";
 	};
+};
 
-	/* osd9616p0899-10 */
-	display@3c {
-		compatible = "solomon,ssd1306fb-i2c";
-		reg = <0x3c>;
-		reset-gpios = <&exp1 14 GPIO_ACTIVE_LOW>;
-		vbat-supply = <&vddb>;
-		solomon,height = <16>;
-		solomon,width = <96>;
-		solomon,com-seq;
-		solomon,com-invdir;
-		solomon,page-offset = <0>;
-		solomon,prechargep1 = <2>;
-		solomon,prechargep2 = <13>;
-	};
+&main_i2c2 {
+	status = "disabled";
+};
+
+
+&main_i2c3 {
+	status = "disabled";
 };
 
+
+
 /* mcu_gpio0 is reserved for mcu firmware usage */
 &mcu_gpio0 {
 	status = "reserved";
-- 
2.25.1

